/*************************************************************************
 *
 *  $RCSfile: AccessibleTextDocumentView.idl,v $
 *
 *  $Revision: 1.3 $
 *
 *  last change: $Author: vg $ $Date: 2003-06-10 11:19:10 $
 *
 *  The Contents of this file are made available subject to the terms of
 *  either of the following licenses
 *
 *         - GNU Lesser General Public License Version 2.1
 *         - Sun Industry Standards Source License Version 1.1
 *
 *  Sun Microsystems Inc., October, 2000
 *
 *  GNU Lesser General Public License Version 2.1
 *  =============================================
 *  Copyright 2000 by Sun Microsystems, Inc.
 *  901 San Antonio Road, Palo Alto, CA 94303, USA
 *
 *  This library is free software; you can redistribute it and/or
 *  modify it under the terms of the GNU Lesser General Public
 *  License version 2.1, as published by the Free Software Foundation.
 *
 *  This library is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 *  Lesser General Public License for more details.
 *
 *  You should have received a copy of the GNU Lesser General Public
 *  License along with this library; if not, write to the Free Software
 *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
 *  MA  02111-1307  USA
 *
 *
 *  Sun Industry Standards Source License Version 1.1
 *  =================================================
 *  The contents of this file are subject to the Sun Industry Standards
 *  Source License Version 1.1 (the "License"); You may not use this file
 *  except in compliance with the License. You may obtain a copy of the
 *  License at http://www.openoffice.org/license.html.
 *
 *  Software provided under this License is provided on an "AS IS" basis,
 *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
 *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
 *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
 *  See the License for the specific provisions governing your rights and
 *  obligations concerning the Software.
 *
 *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
 *
 *  Copyright: 2000 by Sun Microsystems, Inc.
 *
 *  All Rights Reserved.
 *
 *  Contributor(s): _______________________________________
 *
 *
 ************************************************************************/
#ifndef __com_sun_star_text_AccessibleTextDocumentView_idl__
#define __com_sun_star_text_AccessibleTextDocumentView_idl__

#ifndef __com_sun_star_accessibility_XAccessibleContext_idl__
#include <com/sun/star/accessibility/XAccessibleContext.idl>
#endif

#ifndef __com_sun_star_accessibility_XAccessibleComponent_idl__
#include <com/sun/star/accessibility/XAccessibleComponent.idl>
#endif

#ifndef __com_sun_star_accessibility_XAccessibleSelection_idl__
#include <com/sun/star/accessibility/XAccessibleSelection.idl>
#endif

#ifndef __com_sun_star_accessibility_XAccessibleEventBroadcaster_idl__
#include <com/sun/star/accessibility/XAccessibleEventBroadcaster.idl>
#endif


//=============================================================================

module com {  module sun {  module star {  module text {

//=============================================================================

/** The accessible view of a text document.

     @since #107627#
 */
service AccessibleTextDocumentView
{
    /** This interface gives access to any text, table, graphic, embedded
          object and drawing that is at least partially visible on the screen.
        The tree that arises from the children of this object reflects the
        structure of the document as it is displayed.

        <ul>
            <li>The children returned by <type>getAccessibleChild</type> all
                support the interface XAccessible. Calling 
                <type>getAccessibleContext</type> for these children returns
                an object that supports one of the following services.
                <ul>
                    <li><type>com.sun.star.text.AccessibleHeaderFooterView</type>:
                        A child of this kind is returned for every header and
                        footer that is at least partially visible.
                    <li><type>com.sun.star.text.AccessibleFootnoteView</type>:
                        A child of this kind is returned for every footnote
                        that is at least partially visible.
                    <li><type>com.sun.star.text.AccessibleEndnoteView</type>:
                        A child of this kind is returned for every endnote
                        that is at least partially visible.
                    <li><type>com.sun.star.text.AccessibleParagraphView</type>:
                        A child of this kind is returned for every paragraph
                        fragment that is contained in the document body and
                        is at least partially visible. A paragraph fragment is
                        the part of a paragraph that is displayed on a
                        certain page.
                    <li><type>com.sun.star.table.AccessibleTableView</type>:
                        A child of this kind is returned for every table
                        fragment that is contained in the document body
                        and is at least partially visible. A table fragment is
                        the part of a table that is displayed on a certain page.
                    <li><type>com.sun.star.text.AccessibleTextFrameView</type>:
                        A child of this kind is returned for every text frame
                        that is at least partially visible. These objects are
                           children of the
                        <type>AccessibleTextDocumentView</type> regardless
                        whether they are bound to a page, a paragarph, a frame,
                        or a character. The only exception 
                        are text frames that are bound as character. They are 
                        childen of the paragraph they are contained in.
                    <li><type>com.sun.star.text.AccessibleTextGraphicObject</type>:
                        A child of this kind is returned for every graphic that
                        is at least partially visible. These objects are
                        children of the <type>AccessibleTextDocumentView</type>
                        regardless whether they are bound to a page, paragraph,
                        a frame or a character. The only exception 
                        are text frames that are bound as character. They are 
                        childen of the paragraph they are contained in.
                    <li><type>com.sun.star.text.AccessibleTextEmbeddedObject</type>:
                        A child of this kind is returned for every embedded
                        object that is at least partially visible.
                        These objects are children of the
                        <type>AccessibleTextDocumentView</type> regardless
                        whether they are bound to a page, a paragarph, a frame,
                        or a character.  They are childen of the paragraph they
                        are contained in.
                    <li><type>com.sun.star.drawing.Accessible*</type>:
                        A child of this kind is returned for every shape that
                        is at least partially visible. These objects are
                        children of the <type>AccessibleTextDocumentView</type>
                        regardless whether they are bound to a page, a
                        paragraph, a frame or a character.
                </ul>
                <p>The following rules apply to the children order:
                <ul>
                    <li>The logical order of paragraph and table fragments is
                        never changed.
                    <li>Headers appear immediately before the first paragraph or
                        table fragment of the header's page.
                    <li>Footnotes appear immediately after the last paragraph or
                        table fragment of the footnote's page. The logical order
                        of footnotes isn't changed.
                    <li>Endnotes appear immediately after the last footnote of
                        the endnote's page or after the last paragraph or
                        table fragment of this page if there are no footnotes.
                        The logical order of endnotes isn't changed.
                    <li>Footers appear immediately after the last endnote,
                        footnote, paragraph or table fragment of the footer's
                        page.
                    <li>Text frames, graphics, embedded objects and shapes that
                        are painted in the background appear before any other
                        children. Their order reflects the z order.
                    <li>Text frames, graphics, embedded objects and shapes
                        that are painted in the foreground appear behind any
                           other children. Their order reflects the z order,
                        with the exception of controls that appear really last,
                        but also keep the z order.
                </ul>
            <li>The role is <type>DOCUMENT</type>.
            <li>The name is "document view" (or the equivalent term
                in application's language).
            <li>The description also is "document view" (or the equivalent term
                in application's language).
            <li>There are no relation sets.
            <li>The following states might be contained in the state set
                returned by <type>getAccessibleStateSet</type>:
                <ul>
                    <li><type>DEFUNC</type> (indicates that the document
                        window has been closed)
                    <li><type>EDITABLE</type>
                    <li><type>ENABLED</type> (always contained)
                    <li><type>MULTI_SELECTABLE</type> (always contained)
                    <li><type>OPAQUE</type> (always contained)
                    <li><type>SHOWING</type>
                    <li><type>VISIBLE</type>
                </ul>
            <li>Depending of the application's region setting, the locale is
                the western, asian or complex default language of the document.
        </ul>

     */
    interface ::com::sun::star::accessibility::XAccessibleContext;

    /** This interface describes the graphical representation of a text
          document view.
     */
    interface ::com::sun::star::accessibility::XAccessibleComponent;

    /** This interface is for selecting the document's children. Selectable
          are any children with the exception of headers, footers, footnotes
        and endnotes, where only the grandchildren might be selectable.
     */
    interface ::com::sun::star::accessibility::XAccessibleSelection;

    /** This is the interface for listeners */
    interface ::com::sun::star::accessibility::XAccessibleEventBroadcaster;
};

//=============================================================================

}; }; }; };

#endif
