/*************************************************************************
 *
 *  $RCSfile: XMailService.idl,v $
 *
 *  $Revision: 1.2 $
 *
 *  last change: $Author: rt $ $Date: 2004-09-20 13:31:56 $
 *
 *  The Contents of this file are made available subject to the terms of
 *  either of the following licenses
 *
 *         - GNU Lesser General Public License Version 2.1
 *         - Sun Industry Standards Source License Version 1.1
 *
 *  Sun Microsystems Inc., October, 2000
 *
 *  GNU Lesser General Public License Version 2.1
 *  =============================================
 *  Copyright 2000 by Sun Microsystems, Inc.
 *  901 San Antonio Road, Palo Alto, CA 94303, USA
 *
 *  This library is free software; you can redistribute it and/or
 *  modify it under the terms of the GNU Lesser General Public
 *  License version 2.1, as published by the Free Software Foundation.
 *
 *  This library is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 *  Lesser General Public License for more details.
 *
 *  You should have received a copy of the GNU Lesser General Public
 *  License along with this library; if not, write to the Free Software
 *  Foundation, Inc., 59 Temple Place, Suite 330, Boston,
 *  MA  02111-1307  USA
 *
 *
 *  Sun Industry Standards Source License Version 1.1
 *  =================================================
 *  The contents of this file are subject to the Sun Industry Standards
 *  Source License Version 1.1 (the "License"); You may not use this file
 *  except in compliance with the License. You may obtain a copy of the
 *  License at http://www.openoffice.org/license.html.
 *
 *  Software provided under this License is provided on an "AS IS" basis,
 *  WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING,
 *  WITHOUT LIMITATION, WARRANTIES THAT THE SOFTWARE IS FREE OF DEFECTS,
 *  MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE, OR NON-INFRINGING.
 *  See the License for the specific provisions governing your rights and
 *  obligations concerning the Software.
 *
 *  The Initial Developer of the Original Code is: Sun Microsystems, Inc.
 *
 *  Copyright: 2003 by Sun Microsystems, Inc.
 *
 *  All Rights Reserved.
 *
 *  Contributor(s): _______________________________________
 *
 *
 ************************************************************************/

#ifndef __com_sun_star_mail_XMailService_idl__
#define __com_sun_star_mail_XMailService_idl__

#ifndef __com_sun_star_uno_XInterface_idl__ 
#include <com/sun/star/uno/XInterface.idl>
#endif

#ifndef __com_sun_star_mail_XAuthenticator_idl__
#include <com/sun/star/mail/XAuthenticator.idl>
#endif

#ifndef __com_sun_star_auth_AuthenticationFailedException_idl__
#include <com/sun/star/auth/AuthenticationFailedException.idl>
#endif

#ifndef __com_sun_star_io_AlreadyConnectedException_idl__
#include <com/sun/star/io/AlreadyConnectedException.idl>
#endif

#ifndef __com_sun_star_io_NotConnectedException_idl__
#include <com/sun/star/io/NotConnectedException.idl>
#endif

#ifndef __com_sun_star_io_UnknownHostException_idl__
#include <com/sun/star/io/UnknownHostException.idl>
#endif

#ifndef __com_sun_star_io_NoRouteToHostException_idl__
#include <com/sun/star/io/NoRouteToHostException.idl>
#endif

#ifndef __com_sun_star_io_ConnectException_idl__
#include <com/sun/star/io/ConnectException.idl>
#endif

#ifndef __com_sun_star_lang_IllegalArgumentException_idl__ 
#include <com/sun/star/lang/IllegalArgumentException.idl>
#endif

#ifndef __com_sun_star_mail_XConnectionListener_idl__
#include <com/sun/star/mail/XConnectionListener.idl>
#endif

#ifndef __com_sun_star_mail_MailException_idl__
#include <com/sun/star/mail/MailException.idl>
#endif

#ifndef __com_sun_star_uno_XCurrentContext_idl__ 
#include <com/sun/star/uno/XCurrentContext.idl>
#endif


module com { module sun { module star { module mail {

/**
   Represents a mail server abstraction. 
      
   @since #116332#
 */
interface XMailService: ::com::sun::star::uno::XInterface {
       
    /**
        Returns all connection types which are supported to 
        connect to the mail service. At least support insecure 
        connections must be supported. Currently defined 
        connection types are (the values should be handled
        case insensitive):
        "Insecure" - insecure connections 
        "Ssl" - Secure Socket Layer 2.0/3.0 based connection                        
        
        @returns 
        a sequence of supported connection types.       
    */
    sequence<string> getSupportedConnectionTypes();
                    
    /** 
        Register a connection listener.
        
        @param xListener
        [in] a listener that will be informed about connection events.
        
        @see com::sun::star::mail::XConnectionListener
    */
    void addConnectionListener([in] XConnectionListener xListener);
      
    /**
        Unregister a connection listener.
        
        @param xListener
        [in] a listener that no longer need to be informed about connection events.
        
        @see com::sun::star::mail::XConnectionListener
    */
    void removeConnectionListener([in] XConnectionListener xListener);

    /**
        Return the context of the current connnection. The context
        contains information like the server name, port, connection type
        etc.
        
        @precond 
        <code>isConnected</code> returns true.
        
        @returns
        the current connection context.
        
        @throws com::sun::star::io::NotConnectedException
        if no connection is currently established.
        
        @see com::sun::star::mail::connectUser
        @see com::sun::star::io::NotConnectedException
    */
    com::sun::star::uno::XCurrentContext getCurrentConnectionContext()
        raises(com::sun::star::io::NotConnectedException);
                          
    /** 
        Connect to a mail service. Only one connection to a mail service
        can be established at a time. 
        
        @param xConnectionContext
        [in] an interface used to query for connection related information.
        The context must contain the following values:
        "ServerName" of type 'string', "Port" of type 'long', "ConnectionType"
        of type 'string'. A list of supported connection types can be queried
        using <code>getSupportedConnectionTypes</code>.
        
        @param xAuthenticator
        [in] an interface used to query for the necessary user information
        needed to login to the mail server. If no authentication is required
        the xAuthenticator must return an empty user name and an empty password.
        
        @throws com::sun::star::lang::IllegalArgumentException
        if the provided connection context contains invalid values or 
        misses required connection parameters.
        
        @throws com::sun::star::io::AlreadyConnectedException
        on a try to connect to an already connect mail server.
        
        @throws com::sun::star::io::UnknownHostException  
        usually if the IP address of the mail server could not be
        determined. Possible causes are a broken network connection,
        a wrong server name, an unreachable DNS server, etc.
              
        @throws com::sun::star::io::NoRouteToHostException        
        if an error occured to connect to the remote mail server.
        Typically the remote mail server cannot be reach because of an 
        intervening firewall, or if an intermediate router is down, 
        the network connection is broken, etc.
        
        @throws com::sun::star::io::ConnectException
        if an error occured while attempting to connect to the remote
        mail server. Typically the connection was refused remotely, 
        because the mail server is not listening on the remote address/port.
        
        @throws com::sun::star::auth::AuthenticationException 
        if the specified user could not be logged in. 
                
        @throws com::sun::star::mail::MailException
        for other errors during login.        
        
        @see com::sun::star::uno::XCurrentContext
        @see com::sun::star::mail::XAuthenticator
        @see com::sun::star::lang::IllegalArgumentException
        @see com::sun::star::io::AlreadyConnectedException                        
        @see com::sun::star::io::UnknownHostException
        @see com::sun::star::io::NoRouteToHostException
        @see com::sun::star::io::ConnectException
        @see com::sun::star::auth::AuthenticationException         
        @see com::sun::star::mail::IllegalStateException
        @see com::sun::star::mail::MailException
    */    
    void connect([in] com::sun::star::uno::XCurrentContext xConnectionContext, [in] XAuthenticator xAuthenticator)
        raises(com::sun::star::lang::IllegalArgumentException,
               com::sun::star::io::AlreadyConnectedException, 
               com::sun::star::io::UnknownHostException,
               com::sun::star::io::NoRouteToHostException,
               com::sun::star::io::ConnectException,
               com::sun::star::auth::AuthenticationFailedException, 
               com::sun::star::mail::MailException);
         
    /**
        Disconnect from a mail service.
        
        @throws com::sun::star::mail::MailException
        if errors occur during disconnecting.
    */
    void disconnect() 
        raises(com::sun::star::mail::MailException);
    
    /**
        Returns whether a connection to a mail service 
        currently exist or not.
        
        @returns
        <TRUE/> if a connection to a mail service is established.
    */
    boolean isConnected();             
};

}; }; }; };

#endif
