/*************************************************************************
 *
 *  OpenOffice.org - a multi-platform office productivity suite
 *
 *  $RCSfile: AddIn.idl,v $
 *
 *  $Revision: 1.9 $
 *
 *  last change: $Author: rt $ $Date: 2005-09-08 04:23:13 $
 *
 *  The Contents of this file are made available subject to
 *  the terms of GNU Lesser General Public License Version 2.1.
 *
 *
 *    GNU Lesser General Public License Version 2.1
 *    =============================================
 *    Copyright 2005 by Sun Microsystems, Inc.
 *    901 San Antonio Road, Palo Alto, CA 94303, USA
 *
 *    This library is free software; you can redistribute it and/or
 *    modify it under the terms of the GNU Lesser General Public
 *    License version 2.1, as published by the Free Software Foundation.
 *
 *    This library is distributed in the hope that it will be useful,
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 *    Lesser General Public License for more details.
 *
 *    You should have received a copy of the GNU Lesser General Public
 *    License along with this library; if not, write to the Free Software
 *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
 *    MA  02111-1307  USA
 *
 ************************************************************************/

#ifndef __com_sun_star_sheet_AddIn_idl__
#define __com_sun_star_sheet_AddIn_idl__

#ifndef __com_sun_star_lang_XServiceName_idl__
#include <com/sun/star/lang/XServiceName.idl>
#endif

#ifndef __com_sun_star_sheet_XAddIn_idl__
#include <com/sun/star/sheet/XAddIn.idl>
#endif

#ifndef __com_sun_star_sheet_XCompatibilityNames_idl__
#include <com/sun/star/sheet/XCompatibilityNames.idl>
#endif

//=============================================================================

module com {  module sun {  module star {  module sheet {

//=============================================================================

/** is the base for AddIn services that supply functions which can be called
    by other components.

    <p>Any AddIn implementation must implement a service describing its
    specific set of functions.
    That service must contain the <type>AddIn</type> service, and the
    functions that are implemented, in one or more interfaces.
    The <type scope="com::sun::star::lang">XServiceName</type> interface
    must describe that service, and the <type>XAddIn</type> interface
    must describe the individual functions.</p>

    <p>Each AddIn function can take parameters of the following types:</p>

    <dl>
    <dt><atom>long</atom></dt>
    <dd>for integer values.</dd>

    <dt><atom>double</atom></dt>
    <dd>for floating point values.</dd>

    <dt><atom>string</atom></dt>
    <dd>for text strings.</dd>

    <dt><atom>long[][]</atom></dt>
    <dd>for (two-dimensional) arrays of integer values.</dd>

    <dt><atom>double[][]</atom></dt>
    <dd>for (two-dimensional) arrays of floating point values.</dd>

    <dt><atom>string[][]</atom></dt>
    <dd>for (two-dimensional) arrays of text strings.</dd>

    <dt><atom>any[][]</atom></dt>
    <dd>for (two-dimensional) arrays of mixed contents. Each <atom>any</atom>
    will contain a <atom>double</atom> or a <atom>string</atom>, depending on
    the data.</dd>

    <dt><atom>any</atom></dt>
    <dd>Depending on the data, a <atom>double</atom>, a <atom>string</atom>,
    or an <atom>any[][]</atom> will be passed. If no argument is specified in
    the function call, <void/> will be passed. This allows for optional
    parameters.</dd>

    <dt><type scope="com::sun::star::table">XCellRange</type></dt>
    <dd>for a <type scope="com::sun::star::table">XCellRange</type> interface
    to the source data.</dd>

    <dt><type scope="com::sun::star::beans">XPropertySet</type></dt>
    <dd>for a <type scope="com::sun::star::beans">XPropertySet</type>
    interface to the <type>SpreadsheetDocument</type> making the function
    call. Only one parameter of this type is allowed in each function. It
    can be used to query document settings like
    <member>SpreadsheetDocumentSettings::NullDate</member>.</dd>

    <dt><atom>any[]</atom></dt>
    <dd>for varying parameters. Only the last parameter of a function may
    have this type. It will be filled with the remaining arguments of the
    function call that were not used for the previous parameters. Each
    element of the sequence will be filled as in the case of <atom>any</atom>
    above.</dd>
    </dl>

    <p>Each AddIn function must have one of the following return types:</p>

    <ul>
    <li><atom>long</atom></li>
    <li><atom>double</atom></li>
    <li><atom>string</atom></li>
    <li><atom>long[][]</atom></li>
    <li><atom>double[][]</atom></li>
    <li><atom>string[][]</atom></li>
    <li><atom>any[][]</atom></li>
    <li><type>XVolatileResult</type></li>
    <li><atom>any</atom></li>
    </ul>

    <p>The sequences must contain arrays as described above for the
    parameter types.
    An <type>XVolatileResult</type> return value must contain an object
    implementing the <type>VolatileResult</type> service, that contains
    a volatile result. Subsequent calls with the same parameters must
    return the same object.
    An <atom>any</atom> return value can contain any of the other types.</p>
 */
published service AddIn
{
    // ------------------------------------------------------------------------

    /** contains a method that returns the service name of the add-in.
     */
    interface com::sun::star::lang::XServiceName;

    // ------------------------------------------------------------------------

    /** provides access to function descriptions and localized names
        and descriptions.
      */
    interface com::sun::star::sheet::XAddIn;

    // ------------------------------------------------------------------------

    /**	provides access to compatibility names for the functions.
     */
    [optional] interface com::sun::star::sheet::XCompatibilityNames;
};

//=============================================================================

}; }; }; };

#endif

